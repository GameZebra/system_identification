function [w,h] = wiener_hopf(Ru, Ruy, lag)
N=lag;
A=[];
% Поълване на вектора q със стойностите на Ruy
q=Ruy(lag+2:2*lag+1);
% Попълване на марицата A със стойностите на Ru
for i=1:N
    A=[A Ru(lag+2-i:2*lag+1-i)];
end
% Решаване на уравнението на Винер-Хопф
w = [0; A\q];
%Програмно преобразуване на реалната тегловна функция в преходна функция
h=cumsum(w);
